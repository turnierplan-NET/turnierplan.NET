<div class="card shadow-sm">
  <div class="card-body d-flex flex-column gap-3">
    <div class="fs-5 fw-bold card-title mb-0">
      <span
        class="me-2 d-inline-block text-center text-white"
        style="width: 1.3em; border-radius: 0.4em"
        [ngStyle]="{ 'background-color': '#' + invitationLink.colorCode }">
        <i class="bi bi-link-45deg"></i>
      </span>

      <span>{{ invitationLink.name }}</span>
    </div>

    <div class="row">
      <div class="col-12 col-lg-7 d-flex flex-column">
        <div class="row">
          <div class="col-12 col-md-6 d-flex flex-column">
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.Title"></div>
            <div class="mb-2">{{ invitationLink.title ?? '-' }}</div>
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.Description"></div>
            <div class="mb-2">{{ invitationLink.description ?? '-' }}</div>
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.ValidUntil"></div>
            @if (invitationLink.validUntil) {
              <div class="mb-2">{{ invitationLink.validUntil | translateDate: 'medium' }}</div>
            } @else {
              <div class="mb-2">-</div>
            }
          </div>
          <div class="col-12 col-md-6 d-flex flex-column">
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.ContactPerson"></div>
            <div class="mb-2">{{ invitationLink.contactPerson ?? '-' }}</div>
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.ContactEmail"></div>
            <div class="mb-2">{{ invitationLink.contactEmail ?? '-' }}</div>
            <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.ContactTelephone"></div>
            <div class="mb-2">{{ invitationLink.contactTelephone ?? '-' }}</div>
          </div>
          <div class="col-5 d-flex flex-column"></div>
        </div>

        <div class="fw-bold" translate="Portal.ViewPlanningRealm.InvitationLink.Properties.Logos"></div>
        <div class="d-flex flex-column flex-md-row gap-2 gap-md-5 ps-md-2">
          <tp-image-widget
            [currentImage]="invitationLink.primaryLogo"
            [imageAlt]="'PrimaryLogo'"
            [imageType]="ImageType.SquareLargeLogo"
            [organizationId]="planningRealm.organizationId"
            (imageChange)="setImage('primaryLogo', $event)"
            (apiError)="errorOccured.emit($event)" />
          <tp-image-widget
            [currentImage]="invitationLink.secondaryLogo"
            [imageAlt]="'SecondaryLogo'"
            [imageType]="ImageType.SquareLargeLogo"
            [organizationId]="planningRealm.organizationId"
            (imageChange)="setImage('secondaryLogo', $event)"
            (apiError)="errorOccured.emit($event)" />
        </div>
      </div>
      <div class="col-12 col-lg-5 d-flex flex-column">
        @if (invitationLink.entries.length === 0) {
          <div class="fst-italic" translate="Portal.ViewPlanningRealm.InvitationLink.Tournaments.NoTournaments"></div>
        } @else {
          <table class="table table-sm table-bordered">
            <thead>
              <tr>
                <th translate="Portal.ViewPlanningRealm.InvitationLink.Tournaments.Tournament"></th>
                <th>
                  <span translate="Portal.ViewPlanningRealm.InvitationLink.Tournaments.AllowNewRegistrations"></span>
                  <tp-tooltip-icon
                    [icon]="'question-circle'"
                    [tooltipText]="'Portal.ViewPlanningRealm.InvitationLink.Tournaments.AllowNewRegistrationsTooltip'" />
                </th>
                <th>
                  <span translate="Portal.ViewPlanningRealm.InvitationLink.Tournaments.MaxTeamsPerRegistration"></span>
                  <tp-tooltip-icon
                    [icon]="'question-circle'"
                    [tooltipText]="'Portal.ViewPlanningRealm.InvitationLink.Tournaments.MaxTeamsPerRegistrationTooltip'" />
                </th>
              </tr>
            </thead>
            <tbody>
              @for (entry of invitationLink.entries; track entry.tournamentClassId) {
                @let tournamentClass = findTournamentClassById(entry.tournamentClassId);
                <tr>
                  <td>{{ tournamentClass.name }}</td>
                  <td>
                    @if (entry.allowNewRegistrations) {
                      <i class="text-success bi bi-check-circle-fill"></i>
                    } @else {
                      <i class="text-secondary bi bi-pause-circle"></i>
                    }
                  </td>
                  <td>
                    @if (entry.maxTeamsPerRegistration) {
                      {{ entry.maxTeamsPerRegistration }}
                    } @else {
                      &infin;
                    }
                  </td>
                </tr>
              }
            </tbody>
          </table>
        }
      </div>
    </div>
  </div>
  <div class="card-footer text-end pe-2">
    @let canDelete = invitationLink.numberOfApplications === 0;
    @if (canDelete) {
      <tp-delete-button (confirmed)="deleteRequest.emit(invitationLink.id)" />
    } @else {
      <tp-tooltip-icon [tooltipText]="'Portal.ViewPlanningRealm.InvitationLink.DeleteNotPossible'" />
    }
  </div>
</div>
