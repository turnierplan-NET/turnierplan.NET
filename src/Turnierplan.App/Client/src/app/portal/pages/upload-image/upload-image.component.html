<tp-page-frame *tpLoadingState="loadingState" [ultraSlim]="true" [title]="'Portal.UploadImage.Title' | translate" [backLink]="'../..'">
  @let imageNameInvalid = (imageName.dirty || imageName.touched) && imageName.value.length > 0 && imageName.value.trim().length === 0;

  <div class="mb-3">
    <label for="uploadImage_file" class="form-label" [translate]="'Portal.UploadImage.Form.File'"></label>
    <input class="form-control" type="file" accept="image/png,image/jpeg" id="uploadImage_file" (change)="onFileSelected($event)" />
  </div>
  <div>
    <div>
      <label for="uploadImage_name" class="form-label" translate="Portal.UploadImage.Form.Name"></label>
      <tp-tooltip-icon [tooltipText]="'Portal.UploadImage.NameTooltip'" />
    </div>
    <input
      id="uploadImage_name"
      type="text"
      class="form-control"
      [placeholder]="fallbackName ?? ''"
      [formControl]="imageName"
      [class.is-invalid]="imageNameInvalid" />
    <div class="invalid-feedback" translate="Portal.UploadImage.Form.NameInvalid"></div>
  </div>

  @let previewUrl = previewUrl$ | async;
  @if (previewUrl) {
    <hr />
    <div class="mb-2" translate="Portal.UploadImage.Preview"></div>
    <div class="d-flex flex-row">
      <img class="border shadow-sm" style="max-width: 15em; max-height: 15em" [src]="previewUrl" />
    </div>
  }

  <hr />

  <div class="form-text d-flex flex-row align-items-center">
    <i class="bi bi-info-circle"></i>
    <span class="ms-2" [innerHTML]="'Portal.UploadImage.OrganizationNotice' | translate: { organizationName: organization?.name }"></span>
  </div>

  <hr />

  <div class="d-flex flex-row justify-content-end">
    <tp-action-button
      [type]="'success'"
      [title]="'Portal.UploadImage.Submit'"
      [disabled]="!selectedFile || imageNameInvalid"
      (buttonClick)="confirmButtonClicked()" />
  </div>
</tp-page-frame>
